# NAT

### NAT (Network Address Translation)란?

NAT는 IP 주소 변환 기술로, 네트워크 상에서 사설 IP 주소를 공인 IP 주소로 변환하거나 반대로 변환할 때 사용된다.

 

주로 사설 네트워크, 공인 네트워크 간의 통신을 가능하게 하는 역할을 한다.

### NAT를 사용하는 이유

- 사설 네트워크에 속한 많은 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위해
    
    —> IP 주소 절약
    
- 라우터 외부로 트래픽이 나갈 때 호스트의 사설 IP가 공인 IP로 변환되므로호스트 IP를 숨김
    
    —> 보안
    

### Static NAT (정적 NAT)

- 정적 IP 매핑 : 사설 IP 주소를 하나의 공인 IP 주소에 매핑

- 용도 : 특정 내부 서버에 대해 일관된 공인 IP 주소를 사용해야 할 때 사용한다.

### Dynamic NAT (동적 NAT)

- 동적 IP 매핑 : 사설 IP 주소를 공인 IP 주소 풀에서 사용 가능한 IP로 변환한다.

- 용도 : 사설 네트워크에서 여러 장치가 외부 네트워크에 접근할 때, 공인 IP 주소를 동적으로 할장하여 사용한다.

### PAT (Port Address Translation, 포트 주소 변환)

- 여러 장치가 하나의 공인 IP 주소를 공유 하면서 포트 번호를 이용해 구변한다.
- 용도 : 많은 장치가 하나의 공인 IP 주소를 공유하면서 인터넷에 접근할 수 있도록 한다.

### NAT의 동작 방식

1. 내부 장치에서 외부로 요청
    - 내부 네트워크의 장치가 인터넷에 접속하려 할 때, 사설 IP 주소와 포트 번호를 포함한 패킷이 NAT로 전송

1. NAT 장치에서 IP 주소 변환
    - NAT 장치는 사설 IP 주소를 공인 IP 주소로, 포트 번호를 새로 지정하여 외부 네트워크로 전송

1. 외부 응답 수신
    - 외부 네트워크에서 응답 패킷이 공인 IP 주소와 포트 번호로 돌아온다.

1. NAT 장치에서 응답 변환
    - NAt 장치는 응답 패킷을 내부 장치의 사설 IP 주소로 변환하여 해당 장치에 전달

## AWS에서의 NAT

NAT 게이트웨이는 NAT(네트워크 주소 변환) 서비스이다. NAT 게이트웨이를 사용하면 **프라이빗 서브넷**의 인스턴스가 VPC 외부의 서비스에 연결할 수 있다. <br />
 외부 서비스에서 이러한 **인스턴스와의 연결을 시작할 수는 없도록 할 수 있다**.

AWS에서 NAT 게이트웨이를 만들 때 2가지 중 하나를 지정한다.

- 퍼블릭 NAT 게이트웨이 (디폴트 값) : 사설 ip 주소를 연결하여 **사설 서브넷 인스턴스가 인터넷에 접근**하도록 한다. <BR />
트래픽은 인터넷 게이트웨이를 통해 라우팅된다.

- 프라이빗 NAT 게이트웨이 : 사설 서브넷에 배치되어 인터넷과 연결되지 않는다. <BR /> 
트래픽은 전송 게이트웨이, 가상 프라이빗 게이트웨이를 통해 다른 VPC로 라우팅된다.

- 트래픽 라우팅 : 퍼블릭 / 프라이빗 NAT 게이트웨이를 사용하여 VPC 내, VPC / 온프레미스 네트워크와 연결한다.

온프레미스 네트워크 : **기업이나 조직의 물리적 위치**에 설치된 네트워크 (서버, 네트워크 장비, 저장소 등을 포함한 네트워크 환경)