# PART 07

## 라우터를 한마디로 말하자면?

라우터란, '지능을 가진 경로 배정기 이다.'

라우터는 Layer 3, 즉 네트워크 계층에서 동작하기 때문에 'Layer 3 장비' 라고 한다.

## 라우터는 무슨 일을 할까요?

**라우터가 하는 일**

1. Path Determination (경로 설정)
2. Switching (스위칭)

라우터는 가장 좋은 경로를 설정하기 위해 '라우팅 알고리즘'을 사용하고, 이런 라우팅 알고리즘을 **라우팅 테이블** 에서 관리한다.

## 라우터는 어떻게 생긴 녀석일까요?

**라우터의 구조**

- 램프 (전원, 상태 표시, 링트 표시) 가 있음
- 직접 케이블을 연결할 수 있는 포트가 있음

라우터는 단독형과 모듈형으로 나누어 지는데

만약 네트워크가 확장될 가능성이 있다면 모듈형이 적합하고, 증설, 확장이 없다면 단독형이 적합하다.

라우터 안의 소프트웨어를 IOS (Internetwork Operating System) 이라 한다.
이 소프트웨어에는 라우팅 프로토콜과 보안 기능, 다양한 라우터 운용에 관한 내용이 들어있다.

**라우터의 용어**

- 인터페이스 : 라우터에 나와있는 접속가능한 포트
- Ethernet : 내부 네트워크와 접속할 때 사용하는 인터페이스
- Serial : WAN과의 접속을 위한 것. 'WAN 포트' 라고도 한.
- DSU : 전용선 용 모뎀. 속도, 방식에 따라 DSU, FDSU, CSU로 나누어 짐

### 라우팅 프로토콜과 라우티드 프로토콜

지금까지 배웠던 TCP / IP와 IPX 등과 같은 프로토콜들은 모두 라우티드 프로토콜 이다.

라우티드 프로토콜 (Routed Protocal) : 라우터가 라우팅을 해주는 고객

라우터 입장에서는 라우팅 프로토콜에 따라 라우터의 성능이 결정된다.

**라우팅 프로토콜은 기본적인 4가지**

1. RIP (Routing Information Protocol)
2. IGRP (Interior Gateway Routing Protocol)
3. OSPF (Open Shortest Path First)
4. EIGRP (Enhanced Interior Gateway Protocol)

## 스태틱 라우팅 프로토콜과 다이내믹 라우팅 프로토콜

### 스태택 라우팅 프로토콜

- 라우터에 사람이 일일이 경로를 입력는 것이다. 가장 빠르고 좋은 길을 사람이 찾아서 입력한다.
- 작은 규모의 네트워크에 연결된 라우터에 주로 사용한다.
- 라우팅 성능을 높일 때 사용할 때도 있다.
- 라우터가 선택할 수 있는 경로가 1개 일 때 사용한다.

**특징**

장점

- 라우터는 아무런 활동 없이 제이터를 넘기기만 하면 되기 때문에 부담이 들지 않아, 라우팅 속도와 성능이 좋아진다.
- 메모리도 적게 든다.
- 라우터들 끼리 라우팅 테이블을 교환할 필요가 없다.
- 네트워크의 대역폭을 절약할 수 있다.
- 보안에도 강하다.

단점

- 사람이 일일이 라우터에 목적지 별로 경로를 넣어야 하기 떄문에 힘들다.
- 입력해준 경로에 문제가 생긴다면 고쳐질 때까지 문제가 있는 쪽으로 데이터를 보내려고 한다.

### 다이내믹 라우팅 프로토콜

- 스태틱 라우팅 프로토콜과 달리 문제가 생긴다면 자동으로 판단하고 변경할 수 있다.
- 네트워크 센터와 같이 많은 경로를 처리하는 경우에 사용한다.
- 일반적으로 사용한다.

**특징**

장점

- 사람이 일일이 경로를 입력하지 않아도 라우터가 알아서 가장 좋은 길로 데이터를 보낸다

단점

- 라우터에 부담을 준다.
    1. 라우팅 프로토콜을 이용하여 어떤 길이 빠른 길인지 계산을 한다.
    2. 시간이 지날 때마다 바뀐 정보는 없는지 확인 해야한다.
    3. 이정표를 계속 업데이트 해주어야 한다.

## 라우팅 테이블에 대한 이야기

라우터는 라우팅 네이블이라는 경로에 대한 지도 정보를 유지하고 있다.
하지만 RAM에 올라가기 때문에 파워가 꺼지면 지워진다.

라우팅 테이블을 보기 위해서 'show in route' 라는 명령어를 사용한다.

## AS, 그리고 내부용과 외부용 라우팅 프로토콜

AS (autonomous System) : 하나의 네트워크 관리자에 의해서 관리되는 라우터들의 집단

- 하나의 관리 규정아래서 운용되는 라우터의 집단
- 한 회사나 기업, 또는 단체의 라우터 집단

**라우터들을 다시 AS 그룹으로 묶는 이유**

- 라우터가 가지는 정보를 효율적으로 관리하기 위하여
- 인터넷 서비스를 간편하게 제공하기 위하여
즉, 자신의 AS에 속해있는 라우터에 대한 정보만 알고 있으면 된다.

외부로 나갈 때는 ASBR(문지기 라우터)에게 정보를 물어본 후 나갈 수 있다.

문지기 라우터는 자신의 as와 인접해 있는 다른 AS에 대한 정보를 가지고 있고 외부에서 내부로, 내부에서 외부로 나가는 라우터에게 정보를 제공하는 역할을 한다.

**따라서 라우터들은 인터넷에 접속하더라도 모든 정보를 가지고 있은 필요가 없고, 단지 자신이 속한 AS에 대한 정보만 가지면 된다.**

**포로토콜**

- 내부 프로토콜: RIP, OSPF
- 외부 프로토콜: BGP

## 라우터 설치

- 콘솔 (console)을 이용하여 설치

라우터의 몇가지 모드

1. 프리빌리지드 모드 : 운영자 모드와 구성모드로 이루어져 있다. (Config)
2. 유저 모드 : 유저 모드에서 프리빌리지드 모드로 들어가는 명령어는 'enbale' 이다.
3. 

## 라우터의 정보를 보는 법

1. show version : 라우터의 기본적인 내용 즉, 사용하는 소프트웨어의 버전, 인터페이스의 종류, IOS가 어디서 부팅했는지에 관한 내용을 볼 수 있는 명령어
2. show interface : 현재 라우터가 가지고 있는 모든 인터페이스가 다 보일 뿐만 아니라 현재 상황까지도 상세하게 알 수 있는 명령어이다.
3. show flash : 플래시 메모리를 보는 명령어이다. (플래시 메모리에는 IOS의 이미지 정보가 들어있다.)
4. show processes cpu : 현재 라우터의 동작 상태를 보여주는 명령어이다. 동시에 라우터가 얼마나 일을 하고 있는지 알 수 있다.

## 스태틱 라우터를 이용한 라우터 구성

stub 네트워크 : 오직 하나의 경로만을 통해서 외부 망과 연결된 네트워크를 의미한다.

디폴트 라우터 : 경로를 찾아내지 못한 모든 네트워크들은 모두 이곳으로 가락 미리 정해 놓은 길이다.

**디폴트 라우트가 사용되는 곳**

- 인터넷을 사용하는 라우터
- stub 네트워크에 있는 라우터

**디폴트 라우트를 만드는 법**

1. 디폴트 네트워크를 이용한 방법
2. 스태틱 명령을 이용한 방법

## 알고리즘

- 디스턴스 벡터 (Distance Vector)
- 링크 스테이트 ( Link State )

### 디스턴스 벡터

말 그대로 거리와 방향을 위주로 만들어진 라우팅 알고리즘 이다.
RIP, IGRP 등이 있다.

따라서

- 라우터는 목적지까지의 모든 경로를 자신이 라우팅 테이블 안에 저장하지 않는다.
- 목적지까지의 거리 (홈 카운트 등)와 인접 라우터(Neighbor Router)를 거쳐 가야 하는 지에 대한 방향만 저장한다.

장점

- 메모리 절약
- 라우팅 구성 간단함
- 표준으로 사용함

단점

- 일정 시간마다 업데이트가 일어나기 때문에 트래픽을 낭비함
- 라우팅 테이블에 변화가 생길 경우 변화를 알 때 까지 오래 걸린다.

### 링크 스테이트

하나의 라우터가 모든 목적지의 경로를 알고있는 것이다.
커다란 네트워크에 설치되는 고용량 라우터에 적용시킨다.

장점

- 한 라우터에서 목적지까지의 모든 경로를 알고 있기 때문에 중간에 링크 변화가 생겨도 알아내는 데 걸리는 시간이 짧다.
- 교환이 일어나는 경우에도 테이블 변화가 있는 것만을 교환하기 때문에 트래픽 발생을 주릴 수 있다.

단점

- 라우터가 모든 라우팅 정보를 관리해야 하기 때문에 메오리를 많이 소모하게 된다.
- SPF 계산 등 여러 계산을 하기 때문에 CPU 사용이 많다.